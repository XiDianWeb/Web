# Web应用架构设计
## 一、序言
&#160; &#160; &#160; &#160;我们团队项目旨在开发“大学生职业生涯规划”网站，为了方便网站的开发以及后期的维护和扩展，需要首先对网站Web应用架构进行设计，包括网站的软件结构、逻辑结构、物理结构、层次结构、数据访问模型等进行总体设计，从而提高网站的可用性、可靠性和可扩展性。
## 二、三层应用结构
&#160; &#160; &#160; &#160;在Web应用架构设计中，主要采用三层结构设计，即表示层（user interface layer）、业务层（business logic layer）、数据访问层（data access layer）和数据库。

![image](https://github.com/XiDianWeb/Web/blob/master/Architecture/image/00.png)

&#160; &#160; &#160; &#160;其中，表示层负责具体业务和视图展示，如网站首页以及搜索输入和结果展示；业务层主要提供网站的业务功能；数据访问层提供数据存储访问服务，如数据库、缓存、文件、搜索引擎等；数据库用于系统数据存储和访问。

&#160; &#160; &#160; &#160;在我们团队项目“大学生职业生涯规划网站”系统开发过程中，表示层采用Spring MVC框架，即模型（Module）、视图层（View）、控制层（Controller）。业务层提供包括职位介绍、学习路线、在线习题、用户注册登录等功能。使用MySQL作为数据库，然后通过JDBC进行数据库的连接和操作。
## 三、应用服务与数据库分离
&#160; &#160; &#160; &#160;随着网站的上线，访问量逐步上升，服务器的负载慢慢提高，服务器访问用户数量一旦超载，将会导致用户无法访问的情况发生。为了避免访问过载的情况发生，我们团队采用应用服务与数据库分离的方式，以此来提升网站的负载能力，同时提高网站的容灾能力。

![image](https://github.com/XiDianWeb/Web/blob/master/Architecture/image/01.png)
## 四、应用服务器集群
&#160; &#160; &#160; &#160;随着网站访问量继续增加，单台应用服务器已经无法满足系统需求，我们可以把应用服务器从一台变成了两台甚至多台，从而把用户的请求分散到不同的服务器中，提高Web网站系统的负载能力。多台应用服务器之间没有直接的交互，他们都是依赖数据库各自对用户访问提供服务。

![image](https://github.com/XiDianWeb/Web/blob/master/Architecture/image/02.png)

&#160; &#160; &#160; &#160;为了解决服务器负载均衡的问题，我们采用Http重定向，根据用户的Http请求，计算出一台真实的Web服务器地址，并将该Web服务器地址写入Http重定向响应，然后返回给用户浏览器，通过服务器之间的跳转从而实现服务器的负载均衡。

![image](https://github.com/XiDianWeb/Web/blob/master/Architecture/image/03.png)

## 五、数据存储
&#160; &#160; &#160; &#160;采用html静态化对网站数据进行存储，这样的好处是对于网站生成的html文件，在访问量高的时候，服务器的I/O是一个瓶颈，但数据库的压力小了，而且在更新的时候，需要重新生成。

![image](https://github.com/XiDianWeb/Web/blob/master/Architecture/image/04.png)

&#160; &#160; &#160; &#160;为了进一步提高网站的可靠性，优化用户体验，加快网站响应速度，我们对网站系统应用缓存技术，从而提升网站性能。
缓存分为文件缓存、内存缓存、数据库缓存。通过缓存系统可以提高访问效率，提高服务器吞吐能力，改善用户体验，同时，还可以减轻对数据库及存储集服务器的访问压力。

&#160; &#160; &#160; &#160;随着访问量的增加，逐渐出现许多用户访问同一部分内容的情况，对于这些比较热门的内容，没必要每次都从数据库读取，我们可以使用缓存技术，将访问频率高的热门内容放在缓存中，加快服务器响应速度，方便用户搜索查看。

![image](https://github.com/XiDianWeb/Web/blob/master/Architecture/image/05.png)


## 六、结构优化
- ### 6.1数据库读写分离
&#160; &#160; &#160; &#160;随着访问量的提高，数据库的负载也在慢慢增大，考虑到用户更多的时候访问数据库是在读数据库，采用数据库读写分离的方式，进一步提高系统性能。我们使用MySQL自带的master+slave的方式实现主从复制，从而完成主从数据库的同步。
- ### 6.2使用搜索引擎缓解读库的压力
&#160; &#160; &#160; &#160;数据库做读库的话，常常对模糊查找力不从心，即使做了读写分离，这个问题还未能解决。此时我们可以使用搜索引擎的倒排索引来完成，从而提高查询速度。
- ### 6.3数据库水平拆分与垂直拆分
&#160; &#160; &#160; &#160;网站平台要满足可扩展性需求，对于后期不断植入的新功能要满足网站的稳定性，满足网站的功能扩展，不会出现因为增加某项功能导致网站无法正常运行的情况发生，有利于网站的功能扩展。
&#160; &#160; &#160; &#160;垂直拆分是指把数据库中不同的业务数据拆分到不同的数据库中，即把职位信息、用户信息、学习资料这些数据拆分到不同的数据库中。这样解决了原来把所有业务放在一个数据库中的压力问题，从而可以根据业务的特点进行更多的优化。

&#160; &#160; &#160; &#160;数据水平拆分就是把同一个表中的数据拆分到两个甚至多个数据库中。产生数据水平拆分的原因是某个业务的数据量或者更新量到达了单个数据库的瓶颈，这时就可以把这个表拆分到两个或更多个数据库中。
- ### 6.4应用拆分
&#160; &#160; &#160; &#160;随着业务的发展，业务越来越多，应用越来越大。我们需要考虑如何避免让应用越来越臃肿。这就需要把应用拆开，从一个应用变为两个甚至更多。我们可以把公共的服务拆分出来，形成一种服务化的模式，简称SOA。从而减少代码重复，增加代码复用，使得相同的代码不会散落在不同的应用中，使代码得到更好的维护。
- ### 6.5引用消息中间件
&#160; &#160; &#160; &#160;随着网站的继续发展，我们的系统中可能出现不同语言开发的子模块和部署在不同平台的子系统。此时我们需要使用消息中间件来传递可靠的与平台和语言无关的数据，并且能够把负载均衡透明化，能在调用过程中收集调用数据并分析，推测出网站的访问增长率等等一系列需求，对于网站应该如何成长做出预测。
## 七、网站架构设计
&#160; &#160; &#160; &#160;经过以上流程部分，我们最终实现整个Web应用网站的架构设计，如下图所示：

![image](https://github.com/XiDianWeb/Web/blob/master/Architecture/image/06.png)